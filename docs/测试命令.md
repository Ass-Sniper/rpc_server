> ğŸ’­ å—¯ï¼Œç”¨æˆ·ç°åœ¨é—®çš„æ˜¯â€œæµ‹è¯•RPCçš„å‘½ä»¤â€ã€‚ä¹‹å‰çš„å¯¹è¯å†å²æ˜¾ç¤ºä»–ä»¬åœ¨å¼€å‘ä¸€ä¸ªRPCæœåŠ¡å™¨ï¼Œé‡åˆ°äº†ç¼–è¯‘å’Œé“¾æ¥çš„é—®é¢˜ï¼Œç°åœ¨å¯èƒ½å·²ç»è§£å†³äº†ï¼Œç°åœ¨æƒ³æµ‹è¯•ä»–ä»¬çš„RPCæœåŠ¡æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚æˆ‘éœ€è¦ç†è§£ä»–ä»¬å…·ä½“éœ€è¦ä»€ä¹ˆã€‚
> é¦–å…ˆï¼Œç”¨æˆ·å¯èƒ½éœ€è¦çŸ¥é“å¦‚ä½•å‘é€RPCè¯·æ±‚åˆ°ä»–ä»¬çš„æœåŠ¡å™¨ã€‚æ ¹æ®ä¹‹å‰çš„è®¨è®ºï¼Œä»–ä»¬ä½¿ç”¨äº†libeventå’ŒHTTPï¼Œå¯èƒ½ä»–ä»¬çš„RPCæ˜¯åŸºäºHTTPçš„ï¼Œæ¯”å¦‚é€šè¿‡POSTè¯·æ±‚å‘é€JSONæ•°æ®ã€‚
> æ¥ä¸‹æ¥ï¼Œæˆ‘éœ€è¦è€ƒè™‘å¸¸ç”¨çš„æµ‹è¯•å·¥å…·ã€‚å¯¹äºåŸºäºHTTPçš„RPCï¼Œå¸¸ç”¨çš„æœ‰curlå‘½ä»¤æˆ–è€…Postmanè¿™æ ·çš„GUIå·¥å…·ã€‚å¦‚æœæ˜¯JSON-RPCï¼Œå¯èƒ½éœ€è¦æ„é€ ç‰¹å®šçš„JSONè´Ÿè½½ã€‚
> å¯èƒ½çš„æµ‹è¯•æ­¥éª¤åŒ…æ‹¬ï¼š
> 1. å¯åŠ¨RPCæœåŠ¡å™¨ï¼Œç¡®ä¿å®ƒåœ¨ç›‘å¬æŸä¸ªç«¯å£ï¼Œæ¯”å¦‚8080ã€‚
> 2. ä½¿ç”¨curlå‘é€POSTè¯·æ±‚åˆ°æœåŠ¡å™¨çš„ç«¯ç‚¹ï¼Œä¾‹å¦‚`/api`ã€‚
> 3. æ„é€ ç¬¦åˆé¢„æœŸçš„JSONè¯·æ±‚ä½“ï¼ŒåŒ…å«æ–¹æ³•åå’Œå‚æ•°ã€‚
> 4. æ£€æŸ¥æœåŠ¡å™¨çš„å“åº”æ˜¯å¦ç¬¦åˆé¢„æœŸï¼ŒåŒ…æ‹¬çŠ¶æ€ç å’Œè¿”å›çš„æ•°æ®ã€‚
> ç”¨æˆ·å¯èƒ½éœ€è¦å…·ä½“çš„curlå‘½ä»¤ç¤ºä¾‹ï¼ŒåŒ…æ‹¬è®¾ç½®æ­£ç¡®çš„Content-Typeå¤´éƒ¨ï¼Œå‘é€JSONæ•°æ®ï¼Œå¹¶å¤„ç†å“åº”ã€‚å¦å¤–ï¼Œå¦‚æœä»–ä»¬çš„RPCæœåŠ¡éœ€è¦ç‰¹å®šçš„è·¯ç”±æˆ–å‚æ•°ï¼Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´å‘½ä»¤ã€‚
> æ­¤å¤–ï¼Œç”¨æˆ·å¯èƒ½éœ€è¦éªŒè¯ä¸åŒæƒ…å†µä¸‹çš„å¤„ç†ï¼Œæ¯”å¦‚é”™è¯¯çš„è¯·æ±‚æ ¼å¼ã€æ— æ•ˆçš„æ–¹æ³•åæˆ–å‚æ•°ï¼Œä»¥åŠæœåŠ¡ç«¯é”™è¯¯æ—¶çš„å“åº”ã€‚è¿™æ—¶å€™éœ€è¦ç»™å‡ºå¤šä¸ªcurlç¤ºä¾‹ï¼Œæ¶µç›–æ­£å¸¸å’Œå¼‚å¸¸æƒ…å†µã€‚
> è¿˜è¦è€ƒè™‘åˆ°ä»–ä»¬æ˜¯å¦ä½¿ç”¨äº†TLS/HTTPSï¼Œè¿™æ—¶å€™curlå‘½ä»¤éœ€è¦åŠ ä¸Š`-k`é€‰é¡¹ï¼ˆå¦‚æœä¸éªŒè¯è¯ä¹¦ï¼‰æˆ–æŒ‡å®šè¯ä¹¦è·¯å¾„ã€‚ä¸è¿‡æ ¹æ®ä¹‹å‰çš„Makefileï¼Œä»–ä»¬é“¾æ¥äº†libevent_opensslï¼Œä½†å¯èƒ½æµ‹è¯•æ—¶æš‚æ—¶ç”¨HTTPæ›´æ–¹ä¾¿ã€‚
> æœ€åï¼Œå¯èƒ½éœ€è¦æé†’ç”¨æˆ·æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—ï¼Œç¡®è®¤è¯·æ±‚æ˜¯å¦è¢«æ­£ç¡®å¤„ç†ï¼Œæˆ–è€…æ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯è¾“å‡ºï¼Œä»¥å¸®åŠ©è°ƒè¯•ã€‚
> 

ä»¥ä¸‹æ˜¯æµ‹è¯• RPC æœåŠ¡çš„è¯¦ç»†å‘½ä»¤æŒ‡å—ï¼Œå‡è®¾æ‚¨çš„æœåŠ¡è¿è¡Œåœ¨ `localhost:8080` å¹¶ä½¿ç”¨ JSON-RPC æ ¼å¼ï¼š

### 1. å¯åŠ¨æœåŠ¡ç«¯
```bash
./rpc_server -p 8080 -d  # ä»¥è°ƒè¯•æ¨¡å¼å¯åŠ¨
```

### 2. åŸºç¡€åŠŸèƒ½æµ‹è¯•
```bash
# æµ‹è¯•åŠ æ³•æœåŠ¡
curl -X POST http://localhost:8080/api \
-H "Content-Type: application/json" \
-d '{
    "jsonrpc": "2.0",
    "method": "MathService.Add",
    "params": {"a": 23.5, "b": 17.3},
    "id": 1
}'

# é¢„æœŸæˆåŠŸå“åº”
# {"jsonrpc": "2.0", "result": 40.8, "id": 1}

# æµ‹è¯•é™¤æ³•æœåŠ¡
curl -X POST http://localhost:8080/api \
-H "Content-Type: application/json" \
-d '{
    "jsonrpc": "2.0",
    "method": "MathService.Divide",
    "params": {"numerator": 9, "denominator": 3},
    "id": 2
}'

# é¢„æœŸæˆåŠŸå“åº”
# {"jsonrpc": "2.0", "result": 3.0, "id": 2}
```

### 3. å¼‚å¸¸æƒ…å†µæµ‹è¯•
```bash
# æµ‹è¯•é™¤é›¶é”™è¯¯
curl -X POST http://localhost:8080/api \
-H "Content-Type: application/json" \
-d '{
    "jsonrpc": "2.0",
    "method": "MathService.Divide",
    "params": {"numerator": 5, "denominator": 0},
    "id": 3
}'

# é¢„æœŸé”™è¯¯å“åº”
# {
#   "jsonrpc": "2.0",
#   "error": {
#     "code": -32602,
#     "message": "Division by zero",
#     "data": {"denominator": 0}
#   },
#   "id": 3
# }

# æµ‹è¯•æ— æ•ˆæ–¹æ³•
curl -X POST http://localhost:8080/api \
-H "Content-Type: application/json" \
-d '{
    "jsonrpc": "2.0",
    "method": "InvalidService.Method",
    "params": {},
    "id": 4
}'

# é¢„æœŸé”™è¯¯å“åº”
# {
#   "jsonrpc": "2.0",
#   "error": {
#     "code": -32601,
#     "message": "Method not found"
#   },
#   "id": 4
# }
```

### 4. æ€§èƒ½æµ‹è¯• (ä½¿ç”¨ wrk)
```bash
# å®‰è£…æµ‹è¯•å·¥å…·
sudo apt-get install wrk

# æ‰§è¡Œå‹åŠ›æµ‹è¯• (10çº¿ç¨‹ 100è¿æ¥ æŒç»­30ç§’)
wrk -t10 -c100 -d30s -s post.lua http://localhost:8080/api

# post.lua å†…å®¹
wrk.method = "POST"
wrk.headers["Content-Type"] = "application/json"
wrk.body = '{"jsonrpc":"2.0","method":"MathService.Add","params":{"a":1.1,"b":2.2},"id":1}'
```

### 5. å®‰å…¨æµ‹è¯•
```bash
# æµ‹è¯• SQL æ³¨å…¥é˜²æŠ¤
curl -X POST http://localhost:8080/api \
-H "Content-Type: application/json" \
-d '{
    "method": "UserService.Query",
    "params": {"query": "SELECT * FROM users; DROP TABLE users;"}
}'

# é¢„æœŸåº”è¿”å›å‚æ•°æ ¡éªŒé”™è¯¯
# {"error": {"code": -32602, "message": "Invalid parameters"}}

# æµ‹è¯•å¤§è´Ÿè½½è¯·æ±‚ (1MBæ•°æ®)
dd if=/dev/urandom bs=1024 count=1024 | base64 | curl -X POST \
http://localhost:8080/api -H "Content-Type: application/json" -d @-
```

### 6. ç›‘æ§å‘½ä»¤
```bash
# æŸ¥çœ‹æœåŠ¡ç«¯èµ„æºä½¿ç”¨
watch -n1 "ps -p $(pgrep rpc_server) -o pid,%cpu,%mem,rss,vsz,cmd"

# ç½‘ç»œè¿æ¥ç›‘æ§
ss -tunap | grep 8080
```

### æµ‹è¯•æŠ¥å‘Šç”Ÿæˆ
```bash
# ç”Ÿæˆ HTML æµ‹è¯•æŠ¥å‘Š
curl -s http://localhost:8080/metrics | jq . | tee test-report-$(date +%s).json
```

è¿™äº›å‘½ä»¤è¦†ç›–äº†ï¼š
1. æ­£å¸¸ä¸šåŠ¡æµç¨‹éªŒè¯
2. é”™è¯¯å¤„ç†èƒ½åŠ›æµ‹è¯•
3. æœåŠ¡æ€§èƒ½åŸºå‡†æµ‹è¯•
4. å®‰å…¨é˜²æŠ¤èƒ½åŠ›éªŒè¯
5. å®æ—¶è¿è¡ŒçŠ¶æ€ç›‘æ§

å»ºè®®æŒ‰ç…§é¡ºåºæ‰§è¡Œæµ‹è¯•ï¼Œå¹¶é‡ç‚¹å…³æ³¨ï¼š
- æœåŠ¡å“åº”æ—¶é—´ (åº” < 50ms)
- é”™è¯¯ç‡ (åº” 0%)
- å†…å­˜æ³„æ¼æƒ…å†µ (RSS å†…å­˜åº”ç¨³å®š)
- å¼‚å¸¸æ¢å¤èƒ½åŠ› (æµ‹è¯•åæœåŠ¡åº”ç»§ç»­æ­£å¸¸è¿è¡Œ)